# Git 本地仓库操作指南

## 一、在本地文件夹创建仓库并同步文件的删除和修改

### 1. 创建本地仓库

在想要进行版本管理的文件夹中打开终端（命令行），执行以下命令初始化一个Git仓库：

```bash
git init
```

这个命令会在当前目录下创建一个隐藏的 `.git` 文件夹，包含了Git仓库所需的所有数据。

### 2. 修改文件后文件暂存以及提交

创建或修改文件后，需要将这些更改添加到Git的暂存区：

```bash
# 添加特定文件
git add 文件名

# 添加所有变更的文件
git add .

#指定某类型的文件加入暂存区
git add *文件类型(如git add *png)
```

确认无误后，将暂存区的文件提交到本地仓库，形成一个版本记录：

```bash
git commit -m "提交说明信息"
```

提交说明应该简明扼要地描述这次更改的内容，便于日后查阅。

### 3. 删除被跟踪的文件并同步到仓库

#### 方法一：手动删除文件

1. 手动删除本地文件。
2. 使用以下命令将删除操作添加到暂存区：

   ```bash
   git add -u
   ```

3. 提交删除操作到本地仓库：

   ```bash
   git commit -m "手动删除文件的说明信息"
   ```



#### 方法二：使用命令删除文件

1. 使用以下命令直接删除文件并从版本控制中移除：

   ```bash
   git rm <文件名>
   ```

  

2. 提交删除操作到本地仓库：

   ```bash
   git commit -m "使用命令删除文件的说明信息"
   ```



### 4. 查看仓库状态

随时可以通过以下命令查看当前工作区和暂存区的状态：

```bash
git status
```

这个命令会显示哪些文件已修改但未暂存、哪些文件已暂存但未提交等信息。

### 5. 查看提交历史

查看仓库的提交历史记录：

```bash
git log

# 简洁版本
git log --oneline

# 图形化显示分支和合并历史
git log --graph --oneline --all
```

## 二、从本地仓库恢复指定版本

### 1. 查看提交历史找到目标版本

首先需要查看提交历史，找到要恢复的版本的提交ID（commit hash）：

```bash
git log
```

每个提交都有一个唯一的哈希值（如`3a7e43b9c...`），可以用来标识这个版本。

### 2. 查看特定提交的内容

如果想先查看某个提交的具体更改内容：

```bash
git show 提交ID
```

### 3. 恢复文件到指定版本

### 方法一（常用）：将整个仓库重置到指定版本

```bash
# 软重置 - 保留文件更改但撤销提交
git reset --soft 提交ID

# 混合重置（默认）- 撤销提交和暂存，但保留文件更改
git reset 提交ID
# 或明确指定
git reset --mixed 提交ID

# 硬重置 - 完全恢复到指定版本，丢弃所有未提交的更改
git reset --hard 提交ID
```

这三种重置模式的具体区别如下：

1. **--soft**：
   - 只移动 HEAD 指针指向目标提交
   - 不改变暂存区（index）的内容
   - 不改变工作区的文件内容
   - 所有当前版本与目标版本之间的差异都会保留在暂存区中，准备好可以再次提交
   - 适用场景：想合并多个提交为一个提交，或者想修改上一次的提交信息

2. **--mixed**（默认模式）：
   - 移动 HEAD 指针指向目标提交
   - 重置暂存区内容以匹配目标提交
   - 不改变工作区的文件内容
   - 所有差异会保留在工作区中，但需要重新 `git add` 才能提交
   - 适用场景：想撤销之前的提交但保留所有更改，以便重新整理和提交

3. **--hard**：
   - 移动 HEAD 指针指向目标提交
   - 重置暂存区内容以匹配目标提交
   - 重置工作区内容以匹配目标提交
   - 所有未提交的更改和目标版本之间的差异都会被丢弃
   - 适用场景：想完全放弃当前所有更改，恢复到指定版本的完全相同状态

⚠️ 警告：使用 `--hard` 选项会永久删除当前未提交的更改，请谨慎使用。如果错误执行了硬重置，可以通过 `git reflog` 命令查看操作历史，并可能恢复到重置前的状态。


#### 方法二：检出指定版本的文件（不影响当前分支）

如果只想恢复特定文件到指定版本：

```bash
git checkout 提交ID -- 文件路径
```

这种方式会将指定文件恢复到目标版本的状态，并将更改放入暂存区。

#### 方法三：切换到指定版本（分离头指针状态）

查看指定版本的完整代码：

```bash
git checkout 提交ID
```

注意：这会进入"分离头指针"状态，查看完后应该返回原分支：

```bash
git checkout 分支名称  # 通常是 git checkout master 或 git checkout main
```

#
### 4. 撤销更改

#### 撤销工作区更改（未暂存）

```bash
git checkout -- 文件路径
# 或
git restore 文件路径  # Git 2.23.0 及更高版本
```

#### 撤销暂存区更改（已暂存但未提交）

```bash
git reset HEAD 文件路径
# 或
git restore --staged 文件路径  # Git 2.23.0 及更高版本
```

#### 撤销最近的提交（已提交）

```bash
# 创建一个新提交来撤销之前提交的更改（推荐，不改变历史）
git revert 提交ID

# 或者修改最后一次提交
git commit --amend
```

### 5. 分支操作

创建和使用分支可以更安全地进行版本恢复和功能开发：

```bash
# 创建新分支
git branch 分支名称

# 切换到指定分支
git checkout 分支名称
# 或
git switch 分支名称  # Git 2.23.0 及更高版本

# 创建并切换到新分支
git checkout -b 分支名称
```

通过以上操作，可以有效管理本地Git仓库中的版本历史，在需要时恢复到任意历史版本。
